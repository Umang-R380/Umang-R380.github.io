<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Post Viewer</title>
<link rel="stylesheet" href="style.css">

<!-- MathJax configuration -->
<script>
window.MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']],
    displayMath: [['$$', '$$'], ['\\[', '\\]']],
    packages: {'[+]': ['ams']}
  },
  svg: { fontCache: 'global' }
};
</script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js" async></script>

<!-- Marked.js for Markdown parsing -->
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>

<div id="content">Loading...</div>

<script>
(async () => {
  // Get ?post=filename from URL
  const params = new URLSearchParams(window.location.search);
  const postName = params.get('post');
  if (!postName) {
    document.getElementById('content').innerText = "No post specified.";
    return;
  }

  try {
    // Fetch the markdown file
    const res = await fetch(`posts/${postName}.md`);
    if (!res.ok) throw new Error("Post not found.");
    let markdown = await res.text();

    // Convert [ ... ] math to $ ... $ so MathJax will process it
    markdown = markdown.replace(/\[(.*?)\]/g, (_, math) => `$${math}$`);

    // Render markdown to HTML
    const html = marked.parse(markdown);
    const contentElement = document.getElementById('content');
    contentElement.innerHTML = html;

    // Typeset math after DOM update
    if (window.MathJax && MathJax.typesetPromise) {
      await MathJax.typesetPromise();
    }
  } catch (err) {
    document.getElementById('content').innerText = "Error loading post: " + err.message;
  }
})();
</script>

</body>
</html>


